<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"> <!--use for responsive-->

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="preconnect" href="//fdn.fontcdn.ir"><link rel="preconnect" href="//v1.fontapi.ir"><link href="https://v1.fontapi.ir/css/Vazir" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <title>Hello, world!</title>
  </head>
  <body>
    <!--
      color:
      yellow: #f7ad0e, rgba(247,173,14,255)
      low: #f9c656
      perple: #92187b
      low: #b35da3
      lowest: #debad7
      green_blue: #51d8b8
      
    -->
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">
              <img src="img/theme2.jpg" style="width: 60px;">
              <a class="navbar-brand"  href="#"></a>
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="#">Home</a>
                  </li>
                  <!-- <li class="nav-item">
                    <a class="nav-link" href="#">Features</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">Pricing</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
                  </li> -->
                </ul>
              </div>
            </div>
          </nav>
    </header>
    <div class="container">
        <h6 id="question_box">Well Come</h6 >  
       
          <input id="JayeJadid" type="text" value="........"></input>
          
        <div class="row">
              <div class="col-3">
              <button type="button" class="btnn">Hello</button>
              </div>
              <div class="col-3">
              <button type="button" class="btnn">Hello</button>
              </div>
              <div class="col-3">
              <button type="button" class="btnn">Hello</button>
              </div>
              <div class="col-3">
              <button type="button" class="btnn">Hello</button>
              </div>              
        </div> 
        <div class="row">
          <div class="col-3">
          <button type="button" class="btnn ">Hello</button>
          </div>
          <div class="col-3">
          <button type="button" class="btnn " ">Hello</button>
          </div>
          <div class="col-3">
          <button type="button" class="btnn ">Hello</button>
          </div>
          <div class="col-3">
          <button type="button" class="btnn ">Hello</button>
          </div>              
        </div> 
        
          <button id="next_btn" type="button" style="background-color: #92187b; color: azure;"  onclick="Next()">Next</button>

    
      <div class="card" style="max-width: 300px; min-height: 350px;">
        <img src="img/timer.png" id = "status_img"  style="max-width: 200px ;min-width: 195px;max-height: 300px;" class="card-img-top" alt="...">
      
        <div class="card-body">
          <h5 id = "status_txt" class="card-title">Hurry up!</h5>
          <p id = 'scoreer' class="card-text"> Your score: 0</p>
          <a id="help" class="btn btn-primary" onclick="help()">Help</a> 
        </div>
      </div>
      <button type="button" id="timer" class="btn btn-warning" >Timer</button>

    </div>
    <script type="text/javascript" src="DB.js"></script>
    <script>
      var que_number = 5;//6-1 number of question in DB
      var round = 0; //number of que
      var current_que_ans = que_ans[round];
      var index_ans = 0;
      var temp; //for temprory calc
      var score = 0; //امتیاز


     /*------------------------MAIN-----------------------------*/
      preprocess(round);
      refresh_page(round);
      //start_timer
      

    /*------------------------PROCCESS OF EACH PAGE -----------------------------*/
      var true_guess_number = 0;//number of words user guess true
      
      var answer_arr;//anwer that print of inputbox
      var fill_word_number; //number of '----' in question
      function preprocess(round){
        true_guess_number = 0;
        current_que_ans = que_ans[round];
        //que = current_que_ans['que'];
        //half_ans = current_que_ans['half_ans'];
      
        currentAns = current_que_ans['half_ans'].split(" ");//save to 
        var input_to_fill = current_que_ans['que'].split(" ");
        
       // index_ans = current_que_ans['index'];

        temp = current_que_ans['ans'];
        answer_arr = temp.split(" ");
        fill_word_number = count(currentAns,'----');

      }

      function refresh_page(round){

        //refresh question txt:
        document.getElementById("question_box").innerHTML = current_que_ans['que'];
        //refresh input:
        document.getElementById("JayeJadid").value = current_que_ans['half_ans'];
        //refresh buttons:
        current_buttons = current_que_ans["buttons"];
        page_buttons = document.getElementsByClassName("btnn")
        for(let i = 0; i< current_buttons.length; i++){
          var item = page_buttons[i];
          item.innerHTML = current_buttons[i];
          item.disabled=false;
          item.setAttribute("onclick","checkWord(this)"); //add 'checkword' function
         }
         //refresh status img and txt:
         var status_img = document.getElementById("status_img");
         status_img.src = "img/timer.png";
         document.getElementById("status_txt").innerHTML = "Hurry up!";
        //refresh timer:
         number = 32;
         start_timer();  

         //refresh score:
         
        

      }

      /*------------------------PROCCESS FUNCTION-----------------------------*/

      function checkWord(ElementMoredeNazar){ 
        var content = ElementMoredeNazar.innerHTML;
        //alert(content);
//        var ans = current_que_ans['ans'];
  //      var answer_arr = ans.split(" ");
        for(let i =0; i<answer_arr.length;i++){
          if(answer_arr[i] == content){
            currentAns[i] = content;
            ElementMoredeNazar.disabled=true;
            
            //input_to_fill[index + i] = content;
            document.getElementById("JayeJadid").value=currentAns.join(" ");
            true_guess_number = true_guess_number+1;
            if(true_guess_number == fill_word_number)
            {
              //successful status and alert:
              
              var status_img = document.getElementById("status_img");
              status_img.src = "img/success.gif";
              document.getElementById("status_txt").innerHTML = "Success!";
              score = score +1;

              var audio = new Audio("img/success.mp3");
              audio.play();
              temp = document.getElementById("scoreer");
              temp.innerHTML = "Your score:"+ score ;
              btn_disable();

              stop_timer();              
            }
            return;
          }
        }
          alert("Javabe Eshtebah");       
      } 

      function fail_status(){
        var status_img = document.getElementById("status_img");
        status_img.src = "img/fail1.jpg";
        document.getElementById("status_txt").innerHTML = "Fail!";
        btn_disable();

        document.getElementById("JayeJadid").value = current_que_ans["ans"]
        stop_timer();
        var audio = new Audio("img/fail.mp3");
        audio.play();
      }
      
      /*------------------------BUTTON FUNCTION-----------------------------*/
      function Next(){
        stop_timer();
        round = round +1;
        preprocess(round);
        refresh_page(round); 
        
      }

      function help(){
        temp = document.getElementById("status_img");
        temp.src = current_que_ans['image'];
      }

      function count(arr, word){
        var counter = 0;
        for(var i =0; i<arr.length;i++){
          if(arr[i] == word)
          {
             counter = counter+1; 
          }
        }
        return counter;
      }

      function btn_disable(){
        page_buttons = document.getElementsByClassName("btnn")
        for(let i = 0; i< page_buttons.length; i++){
          var item = page_buttons[i];
          
          item.disabled=true;
      }
    }

   </script>

    <script>

        /*------------------------TIMER FUNCTIONS-----------------------------*/
      
      var number=30 ;
      function Counter(){
        var mybox = document.getElementById("timer");
        if(number > 0){      
          number = number - 1;
          mybox.innerHTML = number;
        }
        else{
          //fali status and alert:
          fail_status();

        }
      }

      var MyCounter ;
      function start_timer(){
        MyCounter = setInterval('Counter()', 1000);
      }
      MyCounter = setInterval('Counter()', 1000);
      
      function stop_timer(){
          //number = 0;
          clearInterval(MyCounter);
        }
     
    </script>
    

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">


    </script>
    
  </body>
</html>